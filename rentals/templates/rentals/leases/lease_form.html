{% extends "base.html" %}
{% load static %}

{% block content %}
<div class="container">
    <h1>{% if object %}Update Lease Contract{% else %}Create New Lease Contract{% endif %}</h1>
    <form method="post" enctype="multipart/form-data">
        {% csrf_token %}
        <div class="form-group">
            <label for="{{ form.property.id_for_label }}">Property:</label>
            {{ form.property }}
        </div>
        <div class="form-group">
            <label for="{{ form.tenant.id_for_label }}">Tenant:</label>
            {{ form.tenant }}
        </div>
        <div class="form-group">
            <label for="{{ form.lease_type.id_for_label }}">Lease Type:</label>
            {{ form.lease_type }}
        </div>
        <div class="form-group">
            <label for="{{ form.start_date.id_for_label }}">Start Date:</label>
            {{ form.start_date }}
        </div>
        <div class="form-group">
            <label for="{{ form.end_date.id_for_label }}">End Date:</label>
            {{ form.end_date }}
        </div>
        <div class="form-group" id="solidarity-clause-group" style="{% if form.lease_type.value != 'colocation' %}display: none;{% endif %}">
            <label for="{{ form.has_solidarity_clause.id_for_label }}">Solidarity Clause:</label>
            {{ form.has_solidarity_clause }}
            <small class="form-text text-muted">If checked, all tenants are jointly liable.</small>
        </div>
        <div class="form-group">
            <label for="{{ form.flat_rate_charges.id_for_label }}">Flat Rate Charges ($):</label>
            {{ form.flat_rate_charges }}
        </div>
        <div class="form-group">
            <label for="{{ form.deposit_amount.id_for_label }}">Deposit Amount ($):</label>
            {{ form.deposit_amount }}
        </div>
        <div class="form-group">
            <label for="{{ form.status.id_for_label }}">Status:</label>
            {{ form.status }}
        </div>
        <div class="form-group">
            <label for="{{ form.contract_document.id_for_label }}">Contract Document:</label>
            {{ form.contract_document }}
        </div>
        <div class="form-group">
            <label for="{{ form.notes.id_for_label }}">Notes:</label>
            {{ form.notes }}
        </div>
        <button type="submit" class="btn btn-primary">Save</button>
        <a href="{% url 'leases:list' %}" class="btn btn-secondary">Cancel</a>
    </form>
</div>

<script>
    // Show/hide solidarity clause based on lease type
    document.addEventListener('DOMContentLoaded', function() {
        const leaseTypeSelect = document.getElementById('{{ form.lease_type.id_for_label }}');
        const solidarityGroup = document.getElementById('solidarity-clause-group');

        leaseTypeSelect.addEventListener('change', function() {
            if (this.value === 'colocation') {
                solidarityGroup.style.display = 'block';
            } else {
                solidarityGroup.style.display = 'none';
            }
        });
    });
</script>
{% endblock %}
